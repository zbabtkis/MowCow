<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: character.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: character.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var Entity = require('./entity'),
    Controller = require('./controller');

/**
 * A movable game entity to render in a world
 *
 * @class Character
 * @extends Entity
 * @param {Object} location Initail coordinates in the game
 * @param {Integer} location.x x-coordinate for character to start in
 * @param {Integer} location.y y-coordinate for character to start in
 * @param {Object} css Css rules to apply to character
 */
function Character(location, options) {
  Entity.apply(this, arguments);
  this.distancePerCycle = 50;
  this.type = 'character';
  this.currentPosition = {
    x: location.x,
    y: location.y
  };
};

Character.prototype = Object.create(Entity.prototype);

/**
 * The character controller
 *
 * @function control
 * @memberof Character#
 * @param {Object} state The control messages being sent
 * @param {Boolean} state.isDirectionUp Whether the character should move up
 * @param {Boolean} state.isDirectionDown Whether the character should move down
 * @param {Boolean} state.isDirectionLeft Whether the character should move left
 * @param {Boolean} state.isDirectionRight Whether the character should move right
 * @return {Character} Instance of this character
 */
Character.prototype.control = function(state) {
  var _x = this.x,
      _y = this.y;

  if(state.isDirectionUp &amp;&amp; this.y > 0) {
    this.y-=Math.min(this.distancePerCycle, this.y);
  }
  
  if(state.isDirectionDown &amp;&amp; this.y + this.options.height &lt; this.world.height) {
    this.y+=Math.min(this.distancePerCycle, this.world.height - this.options.height - this.y);
  }
  
  if(state.isDirectionLeft &amp;&amp; this.x > 0) {
    this.x-=Math.min(this.distancePerCycle, this.x);
  }
  
  if(state.isDirectionRight &amp;&amp; this.x + this.options.width &lt; this.world.width) {
    this.x+=Math.min(this.distancePerCycle, this.world.width - this.options.width - this.x);
  }

  // If the characters position has changed, run its onMove notifiers
  if(_x !== this.x || _y !== this.y) {
    _.forEach(this._onMoveNotifiers, _.bind(function(notifier) {
      notifier({
        x: _.range(this.x, this.x + this.options.width),
        y: _.range(this.y, this.y + this.options.height)
      }, {
        x: _.range(_x, _x + this.options.width),
        y: _.range(_y, _y + this.options.height)
      });
    }, this));
  }
};

Character.prototype.destroy = function() {
  Entity.prototype.destroy.apply(this, arguments);

  if (this.controller instanceof Controller) {
    this.controller.detachEntity(this);
  }
};

/**
 * Handle a collision with another object
 *
 * @function onCollision
 * @memberof Character#
 * @param {Array&lt;Entity>} state Entities that are touching this character
 * @return {Character} This character instance
 */
Character.prototype.onCollision = _.noop;

/**
 * Render the character in the context of the world
 *
 * @function render
 * @memberof Character#
 * @return {Object} Instance of this character
 */
Character.prototype.render = function() {
  var ctx = this.world.ctx;

  this.currentPosition.x += Math.round((this.x - this.currentPosition.x) / 2);
  this.currentPosition.y += Math.round((this.y - this.currentPosition.y) / 2);

  ctx.beginPath();
  ctx.fillStyle = this.options.color;
  ctx.fillRect(this.currentPosition.x, this.currentPosition.y, this.options.width, this.options.height);
  ctx.stroke();
};

module.exports = Character;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AcelerometerController.html">AcelerometerController</a></li><li><a href="Character.html">Character</a></li><li><a href="Controller.html">Controller</a></li><li><a href="Entity.html">Entity</a></li><li><a href="KeyboardController.html">KeyboardController</a></li><li><a href="Level.html">Level</a></li><li><a href="RandomController.html">RandomController</a></li><li><a href="Renderer.html">Renderer</a></li><li><a href="Sprite.html">Sprite</a></li><li><a href="World.html">World</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-beta1</a> on Sun Feb 01 2015 12:33:20 GMT-0800 (PST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
